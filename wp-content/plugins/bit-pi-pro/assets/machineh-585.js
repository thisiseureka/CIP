import{_ as i,dx as l}from"./main-red-poems-invite.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const d=e=>({addConnectionHelpingText:i('You can find credentials from <a target="_blank" class="text-blue-600 underline" rel="noopener noreferrer nofollow" href="https://aistudio.google.com/app/apikey">Here</a>'),componentName:e.componentName.connection,connectionsTypes:[{encryptKeys:["value"],label:i("API Key"),showKey:!1,type:"api_key",verifyConnection:{headers:{Accept:"application/json"},method:"GET",queryParams:{key:""},responseKeyMatch:["models"],url:"https://generativelanguage.googleapis.com/v1beta/models"}}],fieldType:"config",id:"connection-id",label:i("Select Connection"),onConnectionAddChange:"CONNECTION_ADD_CHANGE",onConnectionChange:"SET_CONNECTION",render:!0,value:void 0}),g=({$:e,e:t})=>{e.setThisComponent(n=>{e.util.isConnectionComponent(n)&&n.connectionsTypes.forEach(a=>{var o;a.type==="api_key"&&((o=a.verifyConnection)!=null&&o.queryParams)&&(a.verifyConnection.queryParams.key=t.value)})})},p=e=>({$:t,e:n})=>{t.setThisComponent(a=>{a.value=n}),t.setDb(a=>{a[e]=n})};globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const r="https://generativelanguage.googleapis.com/v1beta/",h=async e=>l({method:"GET",queryParams:{key:{encryption:"hmac_decrypt",value:e}},url:`${r}models`});globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(e,t){return this.cache.has(e)?this.cache.get(e):(this.cache.set(e,t),t)}};const C=async e=>{e.setComponent("model-id",o=>{o.loading=!0});const t=await e.getConnection();if(!t)return;const{data:n,status:a}=await h(t.auth_details.value);if(a!=="success"){e.setComponent("model-id",o=>{e.util.isSelectComponent(o)&&(o.loading=!1,o.status=a,o.invalidMessage=n)}),console.error("Failed to fetch list");return}e.setComponent("model-id",o=>{e.util.isSelectComponent(o)&&(o.options=n==null?void 0:n.models.filter(s=>{var c;return(c=s.supportedGenerationMethods)==null?void 0:c.includes("generateContent")}).map(s=>({label:s.name,value:s.name})),o.loading=!1)})};export{p as a,d as c,C as f,g as h};
