import{a3 as r,a4 as C}from"./_applist-952.js";import{_ as n}from"./main-red-poems-invite.js";import{s as m}from"./machine.-578.js";import{f as c,b as s,a as l}from"./machineh-246.js";import"./lodash-840.js";import"./mutative-12.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(a,e){return this.cache.has(a)?this.cache.get(a):(this.cache.set(a,e),e)}};const _=r(({helpers:a})=>({states:{components:[{addConnectionHelpingText:n("You can get your location API key from: sub account > setting > Business Info > API Key"),componentName:a.componentName.connection,connectionsTypes:[{encryptKeys:["value"],label:n("API Key"),showKey:!1,type:"api_key",verifyConnection:{headers:{Authorization:""},method:"GET",responseKeyMatch:["customFields"],url:"https://rest.gohighlevel.com/v1/custom-fields/"}}],fieldType:"config",id:"connection-id",label:n("Select Connection"),onConnectionAddChange:"CONNECTION_ADD_CHANGE",onConnectionChange:"SET_CONNECTION",render:!0,value:void 0},{componentName:a.componentName.select,fieldType:"config",id:"contact-id",label:n("Select Contact"),onChange:"HANDLE_CONTACT_ID",onRefetch:"REFETCH_CONTACTS",options:[],path:"contactId",placeholder:n("Select a contact"),render:"IF_CONNECTION_SELECTED",required:!0,value:void 0},{addItemButtonLabel:n("Add Item"),componentName:a.componentName.repeaterField,fieldsMetaData:[{componentName:a.componentName.select,label:n("Field"),name:"goHighLevelField",optionFilterProp:"label",options:[],required:!0,showSearch:!0,value:void 0,wrapperClassName:"w-100"},{componentName:a.componentName.mixInput,label:n("Value"),name:"value",required:!0,value:[],wrapperClassName:"w-100"}],id:"field-map",label:n("Field Map"),labelActionIconName:"refresh-cw",labelActionOnClick:"REFETCH_FIELDS",labelActionText:n("Refetch Fields"),loading:!1,onChange:"ON_CHANGE_FIELD_MAP",render:"IF_CONNECTION_SELECTED",value:[],wrapperClassName:"mt-3"},{componentName:a.componentName.select,helperText:n("Choose from pre-existing tags or add new tags by writing and pressing Enter."),id:"tags",label:n("Tags"),mode:"tags",onChange:"HANDLE_TAGS",onRefetch:"REFETCH_TAGS",options:[],path:"tags",placeholder:n("Select Tags to attach with the contact."),render:"IF_CONNECTION_SELECTED",value:void 0}]},actions:{ON_MACHINE_LOAD:async({$:e})=>{m(e,[{db:"connectionId",id:"connection-id"},{db:"contactId",id:"contact-id"},{db:"fieldMap",id:"field-map"},{db:"tags",id:"tags"},{db:"status",id:"status"},{db:"overrideExisting",id:"override-existing"}]),await Promise.all([s(e),l(e),c(e)])},CONNECTION_ADD_CHANGE:({$:e,e:o})=>{e.setThisComponent(t=>{e.util.isConnectionComponent(t)&&t.connectionsTypes.forEach(i=>{var d;i.type==="api_key"&&((d=i.verifyConnection)!=null&&d.headers)&&(i.verifyConnection.headers.Authorization="Bearer "+o.value)})})},HANDLE_CONTACT_ID:({$:e,e:o})=>{e.setThisComponent(t=>{t.value=o}),e.setDb(t=>{t.contactId=o})},HANDLE_TAGS:({$:e,e:o})=>{e.setThisComponent(t=>{t.value=o}),e.setDb(t=>{t.tags=o})},HANDLE_MIX_INPUT:({$:e,e:o})=>{e.setThisComponent(t=>{t.value=o})},IF_CONNECTION_SELECTED:({$:e})=>{var o;return C((o=e.getComponent("connection-id"))==null?void 0:o.value)},ON_CHANGE_FIELD_MAP:({$:e,e:o})=>{e.setThisComponent(t=>{t.value=o}),e.setDb(t=>{t.fieldMap=o})},SET_CONNECTION:async({$:e,e:o})=>{e.setThisComponent(t=>{t.value=o}),e.setDb(t=>{t.connectionId=o}),await Promise.all([s(e),l(e),c(e)])},REFETCH_FIELDS:async({$:e})=>{await l(e)},REFETCH_CONTACTS:async({$:e})=>{await s(e)},REFETCH_TAGS:async({$:e})=>{await c(e)}}}));export{_ as default};
