import{a3 as r,a4 as d}from"./_applist-952.js";import{_ as e}from"./main-red-poems-invite.js";import{s as c}from"./machine.-578.js";import{f as s,g as p}from"./hubspotc-33.js";import{a as n,h as _,c as m,g as E,i}from"./machineh-173.js";import"./lodash-840.js";import"./mutative-12.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(l,a){return this.cache.has(l)?this.cache.get(l):(this.cache.set(l,a),a)}};const h=r(({helpers:l})=>({states:{components:[m(l),{componentName:l.componentName.switch,fieldType:"config",helperText:e("Enable to update a deal if it exists, or add a new one if it does not."),id:"update-deal",label:e("Update Deal"),onChange:"SET_UPDATE_DEAL",render:"IF_CONNECTION_SELECTED",size:"small",value:!1},{allowClear:!0,componentName:l.componentName.select,fieldType:"config",id:"deal-id",isLoadable:!0,label:e("Deals"),onChange:"SET_DEAL",onLoadData:"ON_LOAD_DEAL_DATA",onRefetch:"REFETCH_DEAL",optionFilterProp:"label",options:[],placeholder:e("Select a Deal"),render:"IF_UPDATE_SELECTED",required:!0,showSearch:!0,value:void 0},{componentName:l.componentName.mixInput,helperText:e("A name for this deal."),id:"deal-name",label:e("Deal Name"),onChange:"SET_DEAL_NAME",path:"dealname",render:"IF_CONNECTION_SELECTED",required:!0,value:[]},{componentName:l.componentName.select,id:"pipeline-id",label:e("Pipeline"),onChange:"SET_PIPELINE",options:[{label:e("Sales Pipeline"),value:"default"}],path:"pipeline",placeholder:e("Select a Pipeline"),render:"IF_CONNECTION_SELECTED",required:!0,value:"default"},{componentName:l.componentName.select,id:"deal-stage",label:e("Deal Stage"),onChange:"SET_DEAL_STAGE",options:s,path:"dealstage",placeholder:e("Select a Deal Stage"),render:"IF_CONNECTION_SELECTED",required:!0,value:void 0},{componentName:l.componentName.select,id:"owner-id",isLoadable:!0,label:e("Deal Owner"),onChange:"SET_OWNER",onRefetch:"REFETCH_OWNER",optionFilterProp:"label",options:[],path:"hubspot_owner_id",placeholder:e("Select a Owner"),render:"IF_CONNECTION_SELECTED",showSearch:!0,value:void 0},{componentName:l.componentName.select,id:"deal-type",label:e("Deal Type"),onChange:"SET_DEAL_TYPE",options:[{label:e("New Business"),value:"newbusiness"},{label:e("Existing Business"),value:"existingbusiness"}],path:"dealtype",placeholder:e("Select a Deal Type"),render:"IF_CONNECTION_SELECTED",value:void 0},{componentName:l.componentName.select,id:"priority-id",label:e("Priority"),onChange:"SET_PRIORITY",options:[{label:e("Low"),value:"low"},{label:e("Medium"),value:"medium"},{label:e("High"),value:"high"}],path:"hs_priority",placeholder:e("Select a Priority"),render:"IF_CONNECTION_SELECTED",value:void 0},{componentName:l.componentName.select,id:"forecast-id",label:e("Forecast Category"),onChange:"SET_FORECAST_CATEGORY",options:[{label:e("Not forecasted"),value:"OMIT"},{label:e("Pipeline"),value:"PIPELINE"},{label:e("Best case"),value:"BEST_CASE"},{label:e("Commit"),value:"COMMIT"},{label:e("Closed won"),value:"CLOSED"}],path:"hs_manual_forecast_category",placeholder:e("Select a Forecast Category"),render:"IF_CONNECTION_SELECTED",value:void 0},{componentName:l.componentName.select,id:"traffic-id",label:e("Original Traffic Source"),onChange:"SET_TRAFFIC_SOURCE",options:[{label:e("Organic Search"),value:"ORGANIC_SEARCH"},{label:e("Paid Search"),value:"PAID_SEARCH"},{label:e("Email Marketing"),value:"EMAIL_MARKETING"},{label:e("Organic Social"),value:"SOCIAL_MEDIA"},{label:e("Referrals"),value:"REFERRALS"},{label:e("Other Campaigns"),value:"OTHER_CAMPAIGNS"},{label:e("Direct Traffic"),value:"DIRECT_TRAFFIC"},{label:e("Offline Sources"),value:"OFFLINE"},{label:e("Paid Social"),value:"PAID_SOCIAL"}],path:"hs_analytics_source",placeholder:e("Select a Traffic Source"),render:"IF_CONNECTION_SELECTED",value:void 0},{addItemButtonLabel:"Add Deal Field",componentName:l.componentName.repeaterField,fieldsMetaData:[{componentName:l.componentName.select,label:e("Field"),name:"hubSpotFields",optionFilterProp:"label",options:p,showSearch:!0,style:{width:150},value:""},{componentName:l.componentName.mixInput,label:e("Value"),name:"value",value:[],wrapperClassName:"w-100"}],id:"deal-list",label:e("Deal Fields"),onChange:"ON_FIELD_MAP_CHANGE",render:"IF_CONNECTION_SELECTED",value:[]}]},actions:{CONNECTION_ADD_CHANGE:_,IF_CONNECTION_SELECTED:({$:a})=>{var o;return d((o=a.getComponent("connection-id"))==null?void 0:o.value)},SET_CONNECTION:async({$:a,e:o})=>{a.setThisComponent(t=>{t.value=o}),a.setDb(t=>{t.connectionId=o}),await Promise.all([E(a),i(a)])},IF_UPDATE_SELECTED:({$:a})=>{var o,t;if(((o=a.getComponent("update-deal"))==null?void 0:o.value)===!0&&d((t=a.getComponent("connection-id"))==null?void 0:t.value))return!0},REFETCH_DEAL:async({$:a})=>{await i(a)},ON_LOAD_DEAL_DATA:async({$:a,e:o})=>{await i(a,o.count)},SET_UPDATE_DEAL:n("updateDeal"),SET_DEAL:n("deal"),SET_DEAL_NAME:n("dealName"),SET_PIPELINE:n("pipeline"),SET_DEAL_STAGE:n("dealStage"),SET_OWNER:n("owner"),SET_DEAL_TYPE:n("dealType"),SET_PRIORITY:n("priority"),SET_FORECAST_CATEGORY:n("forecast"),SET_TRAFFIC_SOURCE:n("trafficSource"),ON_FIELD_MAP_CHANGE:async({$:a,e:o})=>{a.setThisComponent(t=>{t.value=o}),a.setDb(t=>{t.dealFields=o})},ON_MACHINE_LOAD:async({$:a})=>{var o;c(a,[{db:"connectionId",id:"connection-id"},{db:"dealName",id:"deal-name"},{db:"deal",id:"deal-id"},{db:"updateDeal",id:"update-deal"},{db:"pipeline",id:"pipeline-id"},{db:"dealStage",id:"deal-stage"},{db:"owner",id:"owner-id"},{db:"dealType",id:"deal-type"},{db:"priority",id:"priority-id"},{db:"forecast",id:"forecast-id"},{db:"trafficSource",id:"traffic-id"},{db:"dealFields",id:"deal-list"}]),(o=a.db)!=null&&o.connectionId&&await Promise.all([E(a),i(a)])}}}));export{h as default};
