import{a3 as r,a4 as d}from"./_applist-952.js";import{_ as a}from"./main-red-poems-invite.js";import{s as m}from"./machine.-578.js";import{f as s,a as l}from"./machineh-246.js";import"./lodash-840.js";import"./mutative-12.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(n,e){return this.cache.has(n)?this.cache.get(n):(this.cache.set(n,e),e)}};const g=r(({helpers:n})=>({states:{components:[{addConnectionHelpingText:a("You can get your location API key from: sub account > setting > Business Info > API Key"),componentName:n.componentName.connection,connectionsTypes:[{encryptKeys:["value"],label:a("API Key"),showKey:!1,type:"api_key",verifyConnection:{headers:{Authorization:""},method:"GET",responseKeyMatch:["customFields"],url:"https://rest.gohighlevel.com/v1/custom-fields/"}}],fieldType:"config",id:"connection-id",label:a("Select Connection"),onConnectionAddChange:"CONNECTION_ADD_CHANGE",onConnectionChange:"SET_CONNECTION",render:!0,value:void 0},{addItemButtonLabel:a("Add Item"),componentName:n.componentName.repeaterField,fieldsMetaData:[{componentName:n.componentName.select,label:a("Field"),name:"goHighLevelField",optionFilterProp:"label",options:[],required:!0,showSearch:!0,value:void 0,wrapperClassName:"w-100"},{componentName:n.componentName.mixInput,label:a("Value"),name:"value",required:!0,value:[],wrapperClassName:"w-100"}],id:"field-map",label:a("Field Map"),labelActionIconName:"refresh-cw",labelActionOnClick:"REFETCH_FIELDS",labelActionText:a("Refetch Fields"),loading:!1,nonRemovableRows:[0],onChange:"ON_CHANGE_FIELD_MAP",render:"IF_CONNECTION_SELECTED",value:[[{disabled:!0,name:"goHighLevelField",value:"email"},{name:"value",value:[]}]],wrapperClassName:"mt-3"},{componentName:n.componentName.select,helperText:a("Choose from pre-existing tags or add new tags by writing and pressing Enter."),id:"tags",label:a("Tags"),mode:"tags",onChange:"HANDLE_TAGS",onRefetch:"REFETCH_TAGS",options:[],path:"tags",placeholder:a("Select Tags to attach with the contact."),render:"IF_CONNECTION_SELECTED",value:void 0}]},actions:{ON_MACHINE_LOAD:async({$:e})=>{m(e,[{db:"connectionId",id:"connection-id"},{db:"fieldMap",id:"field-map"},{db:"tags",id:"tags"},{db:"status",id:"status"},{db:"overrideExisting",id:"override-existing"}]),await Promise.all([l(e),s(e)])},CONNECTION_ADD_CHANGE:({$:e,e:t})=>{e.setThisComponent(o=>{e.util.isConnectionComponent(o)&&o.connectionsTypes.forEach(i=>{var c;i.type==="api_key"&&((c=i.verifyConnection)!=null&&c.headers)&&(i.verifyConnection.headers.Authorization="Bearer "+t.value)})})},HANDLE_TAGS:({$:e,e:t})=>{e.setThisComponent(o=>{o.value=t}),e.setDb(o=>{o.tags=t})},HANDLE_MIX_INPUT:({$:e,e:t})=>{e.setThisComponent(o=>{o.value=t})},IF_CONNECTION_SELECTED:({$:e})=>{var t;return d((t=e.getComponent("connection-id"))==null?void 0:t.value)},ON_CHANGE_FIELD_MAP:({$:e,e:t})=>{e.setThisComponent(o=>{o.value=t}),e.setDb(o=>{o.fieldMap=t})},SET_CONNECTION:async({$:e,e:t})=>{e.setThisComponent(o=>{o.value=t}),e.setDb(o=>{o.connectionId=t}),await Promise.all([l(e),s(e)])},REFETCH_FIELDS:async({$:e})=>{await l(e)},REFETCH_TAGS:async({$:e})=>{await s(e)}}}));export{g as default};
