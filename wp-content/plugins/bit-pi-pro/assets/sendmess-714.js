import{a3 as m,a4 as s}from"./_applist-952.js";import{_ as e}from"./main-red-poems-invite.js";import{s as c}from"./machine.-578.js";import{f as i}from"./machineh-112.js";import{h,a as o,c as E}from"./slackcom-285.js";import"./lodash-840.js";import"./mutative-12.js";globalThis.jotaiAtomCache=globalThis.jotaiAtomCache||{cache:new Map,get(t,a){return this.cache.has(t)?this.cache.get(t):(this.cache.set(t,a),a)}};const u=m(({helpers:t})=>({states:{components:[E(t),{componentName:t.componentName.select,helperText:e("Select a channel from the list. A bot can't post in a private channel if it's not a member - you need to invite it to the channel if you are using bot token."),id:"channel-id",isLoadable:!0,label:e("Channel"),onChange:"SET_CHANNEL",onLoadData:"ON_LOAD_CHANNEL_DATA",onRefetch:"REFETCH_CHANNEL",optionFilterProp:"label",options:[],path:"channel",placeholder:e("Select a Channel"),render:"IF_CONNECTION_SELECTED",required:!0,showSearch:!0,value:void 0},{componentName:t.componentName.mixInput,helperText:e("Specify text of the message to send."),id:"message",label:e("Message"),onChange:"SET_MESSAGE",path:"text",render:"IF_CONNECTION_SELECTED",required:!0,value:[]},{componentName:t.componentName.switch,fieldType:"config",helperText:e("If you Switch No, this message will appear to come from you."),id:"is-bot",label:e("Send as a bot?"),onChange:"SET_BOT_FOR_SEND_MESSAGE",path:"as_user",render:"IF_CONNECTION_SELECTED",size:"small",value:!1},{componentName:t.componentName.mixInput,helperText:e("Specify the bot name here, Note that the Specified bot name will appear in Slack only if you are authorized with bot token."),id:"bot-name",label:e("Bot Name"),onChange:"SET_BOT_NAME",path:"username",render:"IF_BOT_SELECTED",value:[]},{componentName:t.componentName.mixInput,helperText:e("Specify the bot icon URL here, Note that the Specified bot icon will appear in Slack only if you are authorized with bot token."),id:"bot-icon",label:e("Bot Icon"),onChange:"SET_BOT_ICON",path:"icon_url",render:"IF_BOT_SELECTED",value:[]},{componentName:t.componentName.mixInput,helperText:e("Self specified, this will upload the given image URL to Slack and attach it to the message separately."),id:"image",label:e("Attach Image by URL"),onChange:"SET_IMAGE_URL",path:"image_url",render:"IF_CONNECTION_SELECTED",value:[]},{componentName:t.componentName.switch,helperText:e("Enable to automatically expand links in this message. For example: turn a YouTube link into a playable widget."),id:"is-auto-expand",label:e("Auto-Expand Links?"),onChange:"SET_AUTO_EXPAND",path:"unfurl_links",render:"IF_CONNECTION_SELECTED",size:"small",value:!1},{componentName:t.componentName.switch,helperText:e("If Switch No, any usernames and channels mentioned would not be linked (or mentioned). Also affects @channel and @group."),id:"link-names",label:e("Link Usernames and Channel Names?"),onChange:"SET_LINK_NAME",path:"link_names",render:"IF_CONNECTION_SELECTED",size:"small",value:!1},{componentName:t.componentName.mixInput,helperText:e("Enter the time (as a Unix timestamp) when the message should be sent."),id:"schedule-at",label:e("Schedule At"),onChange:"SET_SCHEDULE",path:"post_at",render:"IF_CONNECTION_SELECTED",value:[]},{componentName:t.componentName.mixInput,helperText:e("If you want this to be part of a thread, you will need the timestamp (Ts) of the parent message. For example: 1345232312616.1231232."),id:"thread",label:e("Thread"),onChange:"SET_THREAD",path:"thread_ts",render:"IF_CONNECTION_SELECTED",value:[]},{componentName:t.componentName.note,fieldType:"config",id:"note-id",label:e("Note"),note:["To learn how to fetch message timestamps (ts) from channels, explore the Slack API documentation: [conversations.history](https://api.slack.com/methods/conversations.history)"],render:"IF_CONNECTION_SELECTED"},{componentName:t.componentName.switch,helperText:e("Enable Broadcast to control whether a threaded reply will also be posted as a visible message in the channel."),id:"is-broadcast",label:e("Broadcast Message to Channel?"),onChange:"SET_BROADCAST",path:"reply_broadcast",render:"IF_CONNECTION_SELECTED",size:"small",value:!1}]},actions:{SET_CONNECTION:async({$:a,e:n})=>{o("connection")({$:a,e:n}),await i(a)},IF_CONNECTION_SELECTED:({$:a})=>{var n;return s((n=a.getComponent("connection-id"))==null?void 0:n.value)},IF_BOT_SELECTED:({$:a})=>{var n,l;if(s((n=a.getComponent("connection-id"))==null?void 0:n.value)&&((l=a.getComponent("is-bot"))==null?void 0:l.value)===!0)return!0},REFETCH_CHANNEL:async({$:a})=>{await i(a),a.setComponent("channel-id",n=>{a.util.isSelectComponent(n)&&(n.isLoadable=!0)})},ON_LOAD_CHANNEL_DATA:async({$:a,e:n})=>await i(a,n.count),SET_CHANNEL:o("channel"),SET_MESSAGE:o("message"),SET_BOT_FOR_SEND_MESSAGE:o("bot"),SET_IMAGE_URL:o("imageUrl"),SET_AUTO_EXPAND:o("autoExpand"),SET_LINK_NAME:o("linkName"),SET_SCHEDULE:o("schedule"),SET_THREAD:o("thread"),SET_BROADCAST:o("broadcast"),SET_BOT_NAME:o("botName"),SET_BOT_ICON:o("botIcon"),CONNECTION_ADD_CHANGE:h,ON_MACHINE_LOAD:async({$:a})=>{var n;c(a,[{db:"connection",id:"connection-id"},{db:"channel",id:"channel-id"},{db:"message",id:"message"},{db:"bot",id:"is-bot"},{db:"imageUrl",id:"image"},{db:"autoExpand",id:"is-auto-expand"},{db:"linkName",id:"link-names"},{db:"schedule",id:"schedule-at"},{db:"thread",id:"thread"},{db:"broadcast",id:"is-broadcast"},{db:"botName",id:"bot-name"},{db:"botIcon",id:"bot-icon"}]),(n=a.db)!=null&&n.connection&&await i(a)}}}));export{u as default};
